{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nconst API_KEY = '50832143-3e18ca1c7d3ff8d3379931b93'\nconst BASE_URL = 'https://pixabay.com/api/'\n\nexport async function getImagesByQuery(query, page = 1) {\n    const params = {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page\n    }\n    const { data } = await axios(BASE_URL, { params })\n    // console.log(data);\n    return data\n}\n","\nexport const loader = document.querySelector('.loader')\nexport const loadBtn = document.querySelector('.load-more-btn')\nexport const list = document.querySelector('.gallery')\n\n\nexport function createGallery(images, lightbox) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n<li class=\"gallery-item\"><a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\">\n<div class=\"info\">\n<p><b>Likes</b> ${likes}</p>\n<p><b>Views</b> ${views}</p>\n<p><b>Comments</b> ${comments}</p>\n<p><b>Downloads</b> ${downloads}</p>\n</div>\n</a></li>\n    `).join('')\n\n    list.insertAdjacentHTML('beforeend', markup)\n    if (lightbox) {\n        lightbox.refresh()\n    }\n}\n\n\nexport function showLoader() {\n    loader.classList.remove('hidden');\n}\nexport function hideLoader() {\n    loader.classList.add('hidden');\n}\nexport function showLoadMoreButton() {\n    loadBtn.classList.remove('load-more-btn-hidden');\n}\nexport function hideLoadMoreButton() {\n    loadBtn.classList.add('load-more-btn-hidden');\n}\nexport function clearGallery() {\n    list.innerHTML = ''\n}","import Simplelightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImagesByQuery } from './js/pixabay-api'\nimport { clearGallery, createGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton, loadBtn, list } from './js/render-functions'\n\n\nconst form = document.querySelector('.form')\nlet lightbox = new Simplelightbox('.gallery a')\nlet page = 1;\nlet currentQuery = '';\nlet totalHits = 0;\nconst perPage = 15;\n\n\n\nform.addEventListener('submit', async (event) => {\n    event.preventDefault()\n\n    const query = event.currentTarget.elements[\"search-text\"].value.trim()\n    // console.log(query);\n\n    if (!query) {\n        iziToast.warning({\n            message: 'Please enter a search term!'\n        })\n        return\n    }\n    currentQuery = query;\n    page = 1;\n\n    clearGallery();\n    showLoader();\n    hideLoadMoreButton()\n\n    try {\n        const res = await getImagesByQuery(currentQuery, page);\n        // console.log(res);\n        totalHits = res.totalHits;\n        const totalPages = Math.ceil(totalHits / perPage)\n\n        if (res.hits.length === 0) {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight'\n            })\n        } else {\n            createGallery(res.hits, lightbox)\n\n            if (page < totalPages) {\n                showLoadMoreButton()\n            } else {\n                hideLoadMoreButton();\n                iziToast.info({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    position: 'topRight'\n                });\n            }\n        }\n    } catch (error) {\n        console.log(error.message);\n        iziToast.error({\n            message: 'Something went wrong. Please try again!',\n            position: 'topRight'\n        });\n    } finally {\n        hideLoader();\n    }\n})\n\n\n\n\n\nloadBtn.addEventListener('click', handleLoadMore);\nasync function handleLoadMore() {\n    page++;\n\n    const totalPages = Math.ceil(totalHits / perPage)\n\n    try {\n        const data = await getImagesByQuery(currentQuery, page);\n        // console.log(data);\n\n        createGallery(data.hits, lightbox);\n\n        const { height: cardHeight } = list.firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: 'smooth',\n        });\n        if (page >= totalPages) {\n            hideLoadMoreButton()\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight'\n            })\n        }\n\n    } catch (error) {\n        console.log(error.message);\n        iziToast.error({\n            message: 'Failed to load more images. Please try again!',\n            position: 'topRight'\n        });\n    } finally {\n        hideLoader();\n    }\n}"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","params","data","axios","loader","loadBtn","list","createGallery","images","lightbox","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","clearGallery","form","Simplelightbox","currentQuery","totalHits","perPage","event","iziToast","res","totalPages","error","handleLoadMore","cardHeight"],"mappings":"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"}